{
  "task_id": "MS-009-BUILD",
  "title": "打包APK",
  "status": "assigned",
  "mode": "AUTO_EXECUTE",
  "human_intervention": false,

  "instructions": "自动执行APK打包，不需要人类介入",

  "powershell_commands": [
    {
      "step": 1,
      "description": "关闭Unity",
      "command": "Get-Process -Name 'Unity' -ErrorAction SilentlyContinue | Stop-Process -Force; Start-Sleep -Seconds 5"
    },
    {
      "step": 2,
      "description": "批处理打包APK",
      "command": "& 'D:\\program\\2022.3.47f1c1\\Editor\\Unity.exe' -batchmode -nographics -projectPath 'E:\\AI_Project\\MS\\MoShou' -executeMethod BuildScript.BuildAndroid -quit -logFile 'E:\\AI_Project\\MS\\build.log'"
    },
    {
      "step": 3,
      "description": "等待打包完成",
      "command": "while (Get-Process -Name 'Unity' -ErrorAction SilentlyContinue) { Start-Sleep -Seconds 10; Write-Host 'Building...' }"
    },
    {
      "step": 4,
      "description": "检查APK是否生成",
      "command": "if (Test-Path 'E:\\AI_Project\\MS\\Builds\\Android\\*.apk') { Write-Host 'BUILD SUCCESS'; Get-ChildItem 'E:\\AI_Project\\MS\\Builds\\Android\\*.apk' } else { Write-Host 'BUILD FAILED'; Get-Content 'E:\\AI_Project\\MS\\build.log' -Tail 50 }"
    }
  ],

  "output": {
    "apk_path": "E:\\AI_Project\\MS\\Builds\\Android\\MS.apk",
    "on_success": "通知Claude APK已完成",
    "on_failure": "检查build.log并修复"
  }
}
