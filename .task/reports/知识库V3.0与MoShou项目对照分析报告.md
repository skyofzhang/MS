# 知识库 V3.0 与 MoShou 项目对照分析报告

**知识库来源**：Notion「小游戏知识库 V3.0」  
- 根页面：https://www.notion.so/V3-0-2faba9f99f5881398d78d2cca3256fba  
- 关联子页：12 层架构导航、③ AI开发知识库（WHEN-DO-VERIFY 指令）、主策划案目录  

**项目路径**：`E:\AI_Project\MS\MoShou`  
**分析时间**：2026-02-06  
**说明**：本报告仅做阅读与对照分析，未对项目做任何修改。

---

## 一、知识库 V3.0 要点摘要

### 1.1 项目总控（根页）

| 项 | 知识库约定 |
|----|------------|
| 项目名 | 我叫MT之魔兽归来 |
| 项目代码 | MS |
| 引擎 | Unity 2022.3.47f1c1 |
| 渲染 | URP 14.x |
| 屏幕 | portrait 1080×1920 |
| 平台 | 抖音小游戏、Android、iOS |
| 当前阶段 | Phase 5 已完成 |
| 工程实现 | 68 个 C# 脚本 + 10 个 Editor + 6 个 JSON + 1 个测试 ≈ 85 个文件 |

### 1.2 AI 开发知识库（§1–§6 指令）

- **§1 项目常量**：`PROJECT_CODE=MS`，`ENGINE=Unity 2022.3.47f1c1`，`RENDER_PIPELINE=URP 14.x`，`UNITY_PROJECT_PATH=E:/AI_Project/MS/MoShou/`，竖屏 1080×1920。
- **§2 资源加载（RULE-RES-001～015）**：玩家/怪物/环境/武器/HUD/技能/升级/结算/按钮/通用 UI/VFX/BGM/SFX 的 `Resources.Load` 路径表；标注「总资源数 101，覆盖率 100%」。
- **§3 核心系统调用**：SaveSystem.CurrentPlayerStats、CombatSystem.Instance、MonsterSpawner.Instance、UIManager 面板、场景列表 MainMenu/StageSelect/GameScene。
- **§4 数值常量**：玩家 HP=150、Attack=15、Defense=10、MoveSpeed=4、CritChance=0.1 等；怪物表（史莱姆/哥布林/狼/精英/BOSS）；技能 SK001 多重箭、SK002 穿透箭、SK003 战吼。
- **§5 物理层**：Layer 8=Player、9=Enemy、10=Projectile、11=Environment；碰撞矩阵与 Rigidbody 约定。
- **§6 完成检查**：编译 0 Error、PlayMode 不崩、Visual Self Test（VC-001～008）、核心循环检查。

### 1.3 主策划案（Notion 内）

- Notion 中仅保留目录结构（项目基本信息、核心玩法、战斗/技能/成长/关卡、美术与音频、怪物美术资产）。
- 完整正文（约 49 KB）指向本地文件：`E:AI_Project知识库Docs…主策划案_《我叫MT之魔兽归来》_v3.2.md`，未通过 Notion API 拉取到。

---

## 二、项目与知识库对照

### 2.1 引擎与路径

| 维度 | 知识库 | 项目现状 | 结论 |
|------|--------|----------|------|
| Unity 版本 | 2022.3.47f1c1 | ProjectVersion 一致 | ✅ 一致 |
| 项目路径 | E:/AI_Project/MS/MoShou/ | E:\AI_Project\MS\MoShou | ✅ 一致 |
| 渲染管线 | URP 14.x（V3.0 总控与 §1） | ProjectSettings 未检出 URP 配置 | ⚠️ 项目疑似 Built-In，与知识库「URP」表述不一致 |
| 分辨率/竖屏 | 1080×1920 portrait | Canvas Scaler 等为 1920×1080 参考 | ✅ 竖屏与参考分辨率可视为一致 |

### 2.2 资源路径与 RULE-RES-* 覆盖

- **Models**：`Models/Player/Player_Archer`、`Models/Monsters/Slime/Monster_Slime`、Goblin/Wolf/GoblinElite/GoblinKing、`Models/Environment/`、`Models/Weapons/Weapon_Bow_*` 在 Resources 下均存在，命名与知识库 §2 表一致。
- **Sprites/UI**：HUD、Skills、LevelUp、Result、Buttons、Common 等子目录与 RULE-RES-005～010 的路径对应，且项目内已有对应 png 资源。
- **Audio**：BGM（MainMenu/Battle_Normal/Boss_Battle/Victory/Defeat）与 SFX（Arrow/Skill/Monster/Player/Boss/UI/Amb）在 Resources/Audio 下存在，与 §2 BGM/SFX 表一致。
- **Prefabs/VFX**：知识库要求 Prefabs/VFX 下多种特效；项目仅有 `Resources/Prefabs/VFX/` 及少量文件，VFX 种类未逐条核对。
- **结论**：资源目录与命名与知识库「R01 美术资源清单」及 RULE-RES 路径**高度一致**，可认为资源侧按知识库落地。

### 2.3 脚本与系统实现

| 知识库要求 | 项目实现 | 结论 |
|------------|----------|------|
| SaveSystem.CurrentPlayerStats | SaveSystem 单例 + CurrentPlayerStats，PlayerStats 含 HP/攻防/等级/金币等 | ✅ 一致 |
| CombatSystem 伤害公式（防御减伤、暴击） | CombatSystem 静态类，CalculateDamage、DealDamage，公式与 §3 描述一致 | ✅ 一致 |
| CombatSystem.Instance | 项目为静态类，无 Instance | ⚠️ 实现方式不同，功能等价 |
| MonsterSpawner.Instance / SpawnWave | MonsterSpawner 单例，按波次生成怪物 | ✅ 一致 |
| UIManager 面板（GameHUD、Inventory、Equipment 等） | GameHUD、InventoryPanel、EquipmentPanel、SettingsPanel 等存在 | ✅ 一致 |
| 场景 MainMenu / StageSelect / GameScene | 三场景存在且已加入 Build Settings | ✅ 一致 |
| §4 玩家基础属性（HP 150、Attack 15 等） | PlayerController 中 maxHealth=150、attackDamage=15 等与 §4 一致 | ✅ 一致 |
| 技能 SK001/SK002（多重箭、穿透箭） | PlayerController 中 skill1/skill2 及 CD/倍率/范围等参数与 §4 表一致 | ✅ 一致 |

### 2.4 资源加载与运行时行为

- **RULE-RES-001（加载玩家）**：知识库要求 `Resources.Load<GameObject>("Models/Player/Player_Archer")` 实例化玩家；**GameSceneSetup** 当前仍用 `CreatePrimitive(PrimitiveType.Capsule)` 创建玩家，未走 ResourceLoader 或上述路径。
- **ResourceLoader**：存在且含路径常量、LoadModel/LoadPlayerModel 及 FALLBACK 逻辑，与知识库「FALLBACK」约定相符，但**场景初始化未统一经 ResourceLoader 加载玩家预制体**。
- **怪物/环境/武器**：MonsterSpawner 等是否按 RULE-RES-002/003/004 从 Resources 加载，未逐文件验证；从目录存在性看，具备按知识库路径加载的条件。

### 2.5 物理层与检查清单

- **Layer**：知识库 §5 规定 Layer 8/9/10/11；代码中未见显式设置 `gameObject.layer = 8/9`，多为 Tag「Player」或 FindByTag。若未使用自定义 Layer，与 §5 的碰撞矩阵约定存在**未完全落地**可能。
- **§6 完成检查**：知识库要求「Visual Self Test」菜单及 VC-001～008；项目中存在 `Editor/VisualSelfTest.cs`，可认为**已具备检查框架**，具体检查项是否与 VC-001～008 一一对应需打开脚本核对。

---

## 三、总体结论

### 3.1 一致性高的部分

- **引擎版本、项目路径、场景命名、竖屏与参考分辨率**：与知识库一致。
- **资源目录与 RULE-RES-* 路径**：Models/Sprites/Audio 与知识库 R01 及 §2 表高度一致，资源先行、路径可追溯。
- **核心系统**：SaveSystem、战斗公式、MonsterSpawner、UI 面板、主流程场景与知识库 §3、§4 描述一致。
- **数值与技能**：玩家基础属性、技能 CD/倍率/范围与 §4 数值常量表一致；CombatSystem 为静态类，与知识库「Instance」表述不同但行为等价。

### 3.2 差异与风险

1. **渲染管线**：知识库写「URP 14.x」，项目更像 Built-In；若后续要严格对齐文档，需在「知识库改为 Built-In」或「项目升级 URP」中二选一并统一。
2. **玩家创建方式**：知识库与 RULE-RES-001 要求用预制体 `Models/Player/Player_Archer`；当前 GameSceneSetup 用胶囊体占位，未体现「资源 100% 覆盖」的运行时加载，建议改为通过 ResourceLoader/Resources 加载该预制体。
3. **物理层**：§5 的 Layer 与碰撞矩阵若为强制规范，需在项目中显式设置 Layer 并配置 Physics 矩阵，否则为部分未落地。
4. **主策划案全文**：Notion 内仅目录，完整 49 KB 在本地 md；对「Claude 按知识库开发」的复盘需结合该本地文件，才能做玩法与关卡层面的逐条对照。

### 3.3 评价摘要

- **知识库质量**：V3.0 与 AI 开发知识库采用 JSON + WHEN-DO-VERIFY + 表格式路径，面向 AI 可执行性强；§2 资源表与 §4 数值表可直接驱动实现与配置。
- **项目落地度**：在**不修改任何代码**的前提下，MoShou 在引擎版本、路径、资源结构、核心系统与数值上与知识库 V3.0 的匹配度**约 85%～90%**；主要缺口在「运行时玩家创建未用 RULE-RES-001」、「渲染管线表述不一致」和「物理 Layer 是否按 §5 配置」。
- **建议**：若要以「完全按知识库开发」为验收标准，可优先（1）将 GameScene 中玩家生成改为按 RULE-RES-001 加载 Player_Archer；（2）统一知识库与项目的渲染管线描述或实现；（3）按 §5 配置 Layer 与碰撞矩阵；（4）将主策划案全文纳入 Notion 或可访问路径，便于后续逐条核对。

---

**报告完成。未对仓库做任何修改。**
